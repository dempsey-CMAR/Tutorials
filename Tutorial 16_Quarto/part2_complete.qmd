---
format: 
  docx: 
    reference-doc: CMAR_report_template.docx
    df-print: kable
    toc: true
    toc-depth: 3
execute: 
  echo: false
editor: visual
---

\newpage

```{r}
#| include: false
library(dplyr)
library(ggplot2)
library(palmerpenguins)
library(tidyr)
```

# First level header

We will focus on rendering a Word document. The format is controlled with a combination of markdown syntax and a Microsoft Word reference document.

For more info on how to generate a reference template, see [Happy collaboration with Rmd to docx](https://rmarkdown.rstudio.com/articles_docx.html) or the CMAR SOP0008.

A single \# indicates a first-level header.

## Second level header

\## indicates a second-level header.

We are going to use the [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/) data set to explore making reports with Quarto.

This data set contains size measurements for `r nrow(penguins)` penguins from three species observed on three islands in the Palmer Archipelago, Antarctica.

# Analysis

Here is where we do some analysis on the data. If anything in the dataset changes, we just need to re-render the document for updated tables and figures!

## Summary Tables

The table format is set in the YAML with the entry `df-print: kable` and from the Microsoft Word reference document.

### Table 1

```{r}
penguins %>% 
  count(species)
```

### Table 2

```{r}
penguins %>% 
  select(-year) %>% 
  group_by(species) %>% 
  summarize(across(where(is.numeric), mean, na.rm = TRUE)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
```

\newpage

## Figures

The figure format (size, resolution, caption) are set in the code chunk.

```{r}
#| fig-width: 8
#| fig-cap: "Figure 1: Flipper and bill length."
#| fig-dpi: 600
#| warning: false

ggplot(
  penguins, 
  aes(x = flipper_length_mm, y = bill_length_mm)
) +
  geom_point(aes(color = species, shape = species)) +
  scale_color_manual(values = c("darkorange","purple","cyan4")) +
  labs(
    x = "Flipper length (mm)", y = "Bill length (mm)",
    color = "Penguin species", shape = "Penguin species"
  ) +
  theme_minimal()

```
